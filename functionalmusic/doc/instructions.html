<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- 
	This website is powered by TYPO3 - inspiring people to share!
	TYPO3 is a free open source Content Management Framework initially created by Kasper Skaarhoj and licensed under GNU/GPL.
	TYPO3 is copyright 1998-2013 of Kasper Skaarhoj. Extensions are copyright of their respective owners.
	Information and contribution at http://typo3.org/
-->

<base href="http://cs.lth.se/" />


<meta name="generator" content="TYPO3 4.7 CMS" />

<link rel="stylesheet" type="text/css" href="typo3temp/stylesheet_c89dd1c966.css?1375282766" media="all" />



<script src="fileadmin/template/scripts/jquery.js?1335947431" type="text/javascript"></script>
<script src="fileadmin/template/scripts/jquery-ui.min.js?1335947163" type="text/javascript"></script>
<script src="fileadmin/template/scripts/jquery.lightbox-0.5.js?1335956927" type="text/javascript"></script>


<meta http-equiv="Content-Language" content="sv" />
<meta name="robots" content="index, follow" />
<link rel="stylesheet" type="text/css" href="/fileadmin/template/css/basic.css" />
<link rel="stylesheet" type="text/css" href="/fileadmin/template/css/text_normal.css" />
<link rel="stylesheet" type="text/css" href="/fileadmin/template/css/contrast_normal.css" />
<script type="text/javascript" src="/fileadmin/template/common.js"></script>
<link rel="stylesheet" type="text/css" href="/fileadmin/template/css/lth_01.css" />
<title>Computer Science: EDAN40: Functional Music</title><meta name="keywords" content="" /><meta name="description" content="" />
</head>
<body>

<div align="center">
<div class="templateMain" style="width: 754px; background-color: #ffffff;" align="left"><!--###templateMain### begin -->
<div style="width: 754px; height: 29px;" class="headToolbar"><!--###headToolbar### begin -->
<div class="headToolbarMenu" style="float: left; margin-left: 5px; width: 410px;"><!--###headToolbarMenu### begin -->
<div style="float:left;"><a href="/english/">Home</a>&nbsp;&nbsp;&#124;&nbsp;&nbsp;</div><div style="float:left;"><a href="/english/style_preferences">Style</a>&nbsp;&nbsp;&#124;&nbsp;&nbsp;</div><div style="float:left;"><a href="/english/site_map">Sitemap</a>&nbsp;&nbsp;&#124;&nbsp;&nbsp;</div><div style="float:left;background-image:url(/graphics/se.png);background-repeat:no-repeat;padding-left:20px;background-position:center left;"><a href="">Svenska</a>&nbsp;&nbsp;&#124;&nbsp;&nbsp;</div><div><a href="http://www.lu.se/english/">Lund University</a></div>
<!--###headToolbarMenu### end --></div>
<div class="headToolbarSearch"><!--###headToolbarSearch### begin -->
<form action="/english/search/" method="post" name="searchform"><input name="s" value="1" type="hidden" /><input name="so" value="1" type="hidden" /><input type="hidden" name="i" value="en" /><input type="hidden" name="category" value="cs" /><input name="q" type="text" value="" class="field" />&nbsp;<input name="x" type="submit" value="Search" class="button" /></form>
<!--###headToolbarSearch### end --></div>
<!--###headToolbar### end --></div>
<div class="leftColBg"><!--###leftColBg### begin -->
<div style="width: 573px; float: right;" class="rightTd"><!--###rightTd### begin -->
<div class="columnTop"><!--###columnTop### begin -->
<div class="image" align="left"><!--###image### begin --><img src="http://fileadmin.cs.lth.se/cs/Education/EDAN40/Bilder/Grundplatta_EDAN40.jpg" border="0" height="113" alt="top image" /><!--###image### end --></div>
<!--###columnTop### end --></div>
<div class="mainMenuSelected"><!--###mainMenuSelected### begin -->
<div style="float: left; " class="menuItem "><a href="english/about/"  >About</a></div><div style="float: left; " class="menuItem "><a href="english/education/"  >Education</a></div><div style="float: left; " class="menuItem "><a href="english/research/"  >Research</a></div><div style="float: left; " class="menuItem "><a href="english/contact/"  >Contact</a></div><div style="float: left; " class="menuItem "><a href="english/events/"  >Events</a></div><div style="float: left; " class="menuItem menu_no_border"><a href="english/internal/"  >Internal</a></div>
<!--###mainMenuSelected### end --></div>
<!--###rightTd### end --></div>
<div style="float: left; width: 178px;" class="leftTd"><!--###leftTd### begin -->
<div class="menuLogo" id="LOGO"><a href="http://www.lth.se/english"><img src="/fileadmin/template/images/lth_eng.gif" alt="Lund university - faculty of engineering" border="0" height="113" width="178" /></a></div>
<div class="menuSubHead"><!--###menuSubHead### begin -->
<div class="menuDepartmentLink"><a href="/english/">Computer Science</a></div>
<!--###menuSubHead### end --></div>
<div class="menuSubPlate"><a href="http://cs.lth.se/EDAN40">EDAN40</a></div>
<div class="menu"><!--###menu### begin -->
<ul class="mainnav"><li class="none"><a href="english/course/edan40-functional-programming/course-syllabus/"  >Course Syllabus</a></li></ul><ul class="mainnav"><li class="none"><a href="english/course/edan40-functional-programming/important-dates/"  >Important Dates</a></li></ul><ul class="mainnav"><li class="none"><a href="english/course/edan40-functional-programming/lecture-material/"  >Lecture Material</a></li></ul><ul class="mainnav"><li class="none"><a href="english/course/edan40-functional-programming/class-material/"  >Class Material</a></li></ul><ul class="mainnav"><li class="isunder"><a href="english/course/edan40-functional-programming/programming-assignments/"  >Programming Assignments</a><ul class="subnav"><li class="nosub"><a href="english/course/edan40-functional-programming/programming-assignments/chatterbots/"  >Chatterbots</a></li><li class="isunderactive"><a href="english/course/edan40-functional-programming/programming-assignments/functional-music/"  >Functional Music</a></li><li class="nosub"><a href="english/course/edan40-functional-programming/programming-assignments/string-alignment/"  >String Alignment</a></li><li class="nosub"><a href="english/course/edan40-functional-programming/programming-assignments/functional-parsing/"  >Functional Parsing</a></li></ul></li></ul><ul class="mainnav"><li class="none"><a href="english/course/edan40-functional-programming/examination/"  >Examination</a></li></ul><ul class="mainnav"><li class="none"><a href="english/course/edan40-functional-programming/programming-environment/"  >Programming Environment</a></li></ul><ul class="mainnav"><li class="none"><a href="english/course/edan40-functional-programming/teachers/"  >Teachers</a></li></ul><ul class="mainnav"><li class="none"><a href="english/course/edan40-functional-programming/literature-and-links/"  >Literature and Links</a></li></ul>
<!--###menu### end --></div>
<div class="placeF"><!--###placeF### begin -->
<div class="quickLaunch" style="padding-top: 10px;"><!--###quickLaunch### begin -->

<!--###quickLaunch### end --></div>

<!--###placeF### end --></div>
<!--###leftTd### end --></div>
<div style="float: right; width: 573px;" class="rightTd"><!--###rightTd### begin -->
<div class="columnRight"><!--###columnRight### begin -->

<div style="float: left; width: 573px; padding-bottom: 30px;" class="columnLeft">
	<div class="placeA"><!--###placeA### begin -->
		<div class="contentMain"><!--###contentMain### begin -->
			<a name="content"></a>
			<h1>EDAN40: Functional Music<br /><br /></h1>
			<a title="html" name="c102811"></a><h1>Summary</h1>

<p>The objective of this assignment is to practice:</p>
<ol>
  <li>reading and understanding legacy code, i.e. modules created by others,</li>
  <li>using legacy code for your own needs,</li>
  <li>creating useful data types and data structures,</li>
  <li>documenting your work in form of a literate Haskell program.</li>
</ol>
<p>The assignment is to be completed 
in teams of two.</p>

<p>In this assignment you will apply your functional programming skills to the 
domain of music. Your task is to write a program which takes information from 
a musical score and automatically generates very rudimentary accompaniment to the 
melody. You will base your solution on 1) a model of music expressed in the 
form of a Haskell library for musical structures called 
<a href="http://www.haskell.org/haskellwiki/Haskore">Haskore</a>, and 2) a basic theory of 
musical harmony, expressed below a a set of simple rules to follow. </p>

<p>It may be worth noting that prior knowledge of music is not necessarily an 
advantage. Although the theory presented is hopefully correct, it is expressed in a way 
which most musicians are not familiar with and probably would not approve of. However, 
 keep in mind that <b>this is NOT an exercise in understanding
  music theory; it is an exercise in understanding a clear set of rules to follow and 
  implementing the expected behaviour</b>.</p>

<p>Please have a look at an <a href="http://www.linusakesson.net/music/functional/index.php">exemplary
 solution</a> of this assignment, by Linus &Aring;kesson.</p>

<p>
<!--
<b>Note:</b> The packages available at the Haskore home page may possibly <em>not</em> 
work with the current GHC release. Download a working version from 
<a href="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/Haskore.zip">here</a>
 and unzip it into your assignment folder. Test Haskore by opening the <tt>ChildSong6.lhs</tt> module
 and running <tt>test childSong6</tt> from the GHCi prompt. This will generate a file called <tt>test.mid</tt>
 which can be played using your system midi-player.</p>
<br>
-->

<h1>Musical scores</h1>
<p>Printed music, or scores, uses quite an elaborate notational system to communicate information
 to musicians so that they can play the song. Many songs are built on a melody with accompaniment
 and the score often gives the melody explicitly whereas the accompaniment is described as a more
 abstract harmonic structrure which the musician must translate to musical sounds. For example, in the
 score below, &quot;Twinkle Twinkle Little Star&quot;, the notes show the melody and the harmonic structure
 of the accompaniment is presented as a sequence of chord symbols above the melody line. Click the score
 to hear the song. </p>

<p align="center"><a href="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/twinkle.mid" page=blank>
<img border="0" src="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/twinkle.gif" width="546"
height="212"></a></p>
<br>

<h1>Haskore music</h1>

<p> Haskore is a library of Haskell modules which allows musical structures to be
expressed in a declarative manner. This section gives a beginner's introduction
to music and summarizes the most relevant parts of the
 <a href="http://haskell.cs.yale.edu/?post_type=publication&p=258">Haskore
tutorial</a>.</p>

<p>From a technical point of view, music is simply a collection of notes. Each single note is primarily
 determined by its <i> pitch</i> (frequency) and its <i>duration</i>. When the note is played the resulting
 sound is further characterised by things like:</p>
<ul>
  <li>which instrument it is played on</li>
  <li>how loud it is played</li>
  <li>how it is articulated, e.g. soft, aggressive, distinct, etc.</li>
</ul>
<p>What makes music a bit more complex to approach than this are the conventions and the terminology
 which has developed over time, mainly regarding pitch and duration. Pitch is measured in equidistant discrete
 steps (called
<i>semitones</i>) on a logarithmic frequency scale. This means that the frequency doubles over equal intervals.
 This interval is called an
<i> octave</i> and consists of twelve semitones. On a piano this corresponds to
the fact that an octave consists of seven white keys and five black keys.<br>
<br>
Notes are by convention named by their position within the octave. The notes corresponding to the white piano
 keys are named with single letters C, D, E, F, G, A, and B. The notes corresponding to the black keys are named
 by their relationship to the
neighboring white key as being a sharp (raised) or flat (lowered) version of it. for example, the note between F
 and G can be referred to as both F# (F sharp) and Gb (G flat).</p>
<p align="center"><img border="0" src="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/keys.gif" 
width="496" height="255"/>
<p>
In Haskore these names within an octave are called a <i> pitch classes</i>. The pitch of a note is thus uniquely
 defined by the combination of a name (pitch class) and an octave. The following Haskell definitions therefore gives
 an appropriate model of musical pitch:</p>
<blockquote>
  <p><font face="Courier">type Pitch      = (PitchClass, Octave)<br>
  data PitchClass = Cf | C | Cs | Df | D | Ds | Ef |<br> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
E | Es | Ff | F | Fs | Gf | G |<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  Gs | Af | A | As | Bf | B | Bs<br>
  &nbsp;&nbsp;&nbsp; deriving (Eq,Ord,Ix,Show)<br>
  type Octave     = Int</font></p>
</blockquote>
<p>The duration of individual notes are given by its nominal value which is measured in fractions of a
bar. The duration of a half-note is thus 1/2 and the duration of an eighth-note is 1/8.
In musical notation the nominal duration is indicated by the appearance of the
note:</p>
<p align="center"><img border="0" src="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/notes.gif" width="378" height="76"></p>
<p>The actual duration corresponding to these nominal durations is then determined by a tempo declaration
 valid for the whole musical piece, or at least a larger part of it. A typical example of such a declaration is that
 tempo should be 120 quarter-notes per minute. The Haskore definition of the duration type is:</p>
<blockquote>
  <p><font face="Courier">type Dur = Ratio Int</font></p>
</blockquote>
<p>Musical qualities of the individual notes arise from how they are structured and organized in time.
 The Haskore library defines music with the following recursive algebraic data type (slightly simplified):</p>
<p><font face="Courier">data Music = Note Pitch Dur [NoteAttribute]   -- a note<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 
Rest Dur&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-- a rest (pause)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 
Music :+: Music&nbsp;&nbsp;&nbsp;
-- sequential composition<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 
Music :=: Music&nbsp;&nbsp;&nbsp;
-- parallel composition<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 
Tempo  (Ratio Int) Music&nbsp;
-- scale the tempo<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 
Trans  Int Music&nbsp;&nbsp;&nbsp;
-- transpose (raise <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-- or lower) all notes<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 
Instr  IName Music&nbsp;
-- select instrument<br>
&nbsp;&nbsp;&nbsp;&nbsp; deriving (Show, Eq)</font></p>
<p>A fairly loud C quarter-note in the fourth octave, for example, is a music object which can be expressed:</p>
<blockquote>
  <p><font face="Courier">c4 = Note (C, 4) (1%4) [Volume 80]</font></p>
</blockquote>
<p>The only note attribute we will be concerned with in this assignment is the volume. Its value ranges from
 0 to 100.<br>
<br>
The same note repeated three times and played by a flute can be expressed as:</p>
<blockquote>
  <p><font face="Courier">Instr "flute" (c4 :+: c4 :+: c4)</font></p>
</blockquote>
<p>As instrument you can either use names from the full list of instrument names in the General Midi standard
 which can be found in the Haskore manual, or names from the shorter list below:</p>
<blockquote>
  <p><font face="Courier">&quot;piano&quot;<br>
  &quot;vibes&quot;<br>
  &quot;bass&quot;<br>
  &quot;flute&quot;<br>
  &quot;sax&quot;<br>
  &quot;guitarr&quot;<br>
  &quot;violin&quot;<br>
  &quot;violins&quot;<br>
  &quot;drums&quot;</font></p>
</blockquote>
<p>To build various musical structures you can of course use the full expressive power of Haskell. A chord 
(a number of notes played simultaneousely can for example be expressed with a list comprehension:</p>
<blockquote>
  <p><font face="Courier">cMajor = foldr1 (:=:) [ Note (x, 4) (1%2) [Volume 60] | x&lt;-[C, E, G] ]</font></p>
</blockquote>
<p>When you have built a music object in Haskore you normally want to listen to it. To do so you use the function
<font face="Courier"> test :: Music -> IO ()</font>. It generates a midi-file called
<font face="Courier">test.mid</font> which can be played with ordinary midi-players such as Windows Media
 Player or Winamp.<br>
</p><br>

<h1>Harmonic theory (a.k.a. the rules)</h1>

<h2>Keys, scales and chords </h2>

<p>A vital piece of information in a score is the <em>key</em>
of the song (although how it is present in the score is not obvious to a non-musician).
For example, the key of Twinkle, twinkle above is C major. A musical key has two components: a
 <i>root</i>, which is C
in this case, and a <i>harmonic quality</i> which is either major or minor.</p>

<p>One
of the things the key does is that it defines a <i>scale</i> which gives the (main) note supply for the
song. A scale is a subset of the twelve notes in a full octave<sub> </sub>(the
most commonly used scales consist of seven notes although scales with other numbers of
notes do exist). A scale is usually described by stating the root of the scale, together with a <i> scale
 pattern</i>, which is a list of
semitone distances from the root. For example the key scale of C major is shown below. The
root is C and the semitone distance from the root for each of the notes are shown within
parentheses.</p>

<p align="center"><a href="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/Cmajor.mid">
<img border="0" src="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/Cmajor.gif" width="404"
height="80"></a></p>

<p>This scale pattern is
called the Ionian pattern, and it is used to generate the scales of all major
keys. Similarily, the minor key scales are generated by the
Aeolian pattern. These and a few other patterns are defined in the table
below.
<blockquote>
  <div align="left"><table border="0" height="144">
    <tr>
      <td height="15">Ionian:</td>
      <td height="15"></td>
      <td height="15">0, 2, 4, 5, 7, 9, 11</td>
      <td height="15"></td>
      <td height="15">(Major)</td>
    </tr>
    <tr>
      <td height="21">Lydian:</td>
      <td height="21"></td>
      <td height="21">0, 2, 4, 6, 7, 9, 11</td>
      <td height="21"></td>
      <td height="21"></td>
    </tr>
    <tr>
      <td height="21">Mixolydian:</td>
      <td height="21"></td>
      <td height="21">0, 2, 4, 5, 7, 9, 10</td>
      <td height="21"></td>
      <td height="21"></td>
    </tr>
    <tr>
      <td height="21">Aeolian:</td>
      <td height="21"></td>
      <td height="21">0, 2, 3, 5, 7, 8, 10</td>
      <td height="21"></td>
      <td height="21">(Minor)</td>
    </tr>
    <tr>
      <td height="21">Dorian:</td>
      <td height="21"></td>
      <td height="21">0, 2, 3, 5, 7, 9, 10</td>
      <td height="21"></td>
      <td height="21"></td>
    </tr>
    <tr>
      <td height="21">Phrygian:</td>
      <td height="21"></td>
      <td height="21">0, 1, 3, 5, 7, 8, 10</td>
      <td height="21"></td>
      <td height="21"></td>
    </tr>
  </table>
  </div>
</blockquote>
</p> 

<p>The sequence of chord symbols which describe the harmonic structure of the
accompaniment is called a
<em>chord progression</em>. The chord progression, for example C F C G C etc. for Twinkle, twinkle, gives the
main harmonic structure of the accompaniment. Often there is a single chord symbol for a
whole bar, but sometimes the bar is split by two (or more) different symbols. A
chord is simply a set of notes played simultaneously, for example {C,4; E,4;
G,4} and each chord symbol designates a <i>chord class</i>, which is a set of chords which in a harmonic sense
are equivalent. Formally, a chord class is similar to the concept of a key, in
that it consists of a root and a
harmonic quality. Unlike a key, however, a chord class has the additional information of a <i>chord pattern</i>,
which is a subset of the scale (i.e., a further restriction of the note supply) with notes
to build the chord from. For example the chord class F has F as its root, major
as its harmonic quality and the <i>basic triad</i> as its chord pattern. The
basic triad consist of the first, third and fifth notes in the scale of the
chord (see <i>chord scale</i> below) and is the fundamental and most commonly used chord pattern.
It&nbsp; is
for example the pattern of all the chords for Twinkle, twinkle. When the chord
symbol consists of the root only, the &quot;default&quot; harmonic quality and
chord pattern are major and basic triad respectively. An F minor chord has for
example the symbol Fm.</p>

<p>The chord class also identifies a scale which gives a supply of notes available for accompaniment during
 this part of the song.
This supply is called the <i>chord scale</i> and, as described above, the scale is defined
by a root and a scale pattern. The root of the chord scale is simply the root of the chord
class. The scale pattern, however, is a bit trickier to obtain. According to the
theory of tonal music, this scale pattern depends on the so called <i>function</i> of the chord class.
A full definition of this function is beyond the scope of this assignment, but
an operational defintion sufficient for our purposes is that the function of a
chord is given by the position of the root of the chord class with respect to the scale of
the key together with the harmonic quality of the chord. For each such
combination of harmonic quality and position in the key scale, the
theory of tonal music associates a specific scale pattern. The table below shows some of
these associations, that is, scale patterns for the most common major and minor chords in
major keys. The scale patterns for more unusual chords have been omitted. </p>
<blockquote>
  <div align="left"><table border="0">
    <tr>
      <td>Position</td>
      <td></td>
      <td>Major chord</td>
      <td></td>
      <td>Minor chord</td>
    </tr>
    <tr>
      <td>1</td>
      <td></td>
      <td>Ionian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>2</td>
      <td></td>
      <td>Mixolydian</td>
      <td></td>
      <td>Dorian</td>
    </tr>
    <tr>
      <td>3</td>
      <td></td>
      <td></td>
      <td></td>
      <td>Phrygian</td>
    </tr>
    <tr>
      <td>4</td>
      <td></td>
      <td>Lydian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>5</td>
      <td></td>
      <td>Mixolydian</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td>6</td>
      <td></td>
      <td></td>
      <td></td>
      <td>Aeolian</td>
    </tr>
    <tr>
      <td>7</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </table>
  </div><p>&nbsp;</p>
</blockquote>

<p>Consider as an example a chord symbol G in Twinkle, twinkle. This symbol
designates the chord class G major, that is the root is G and the harmonic
quality is major. The key of the song is C major and in figure above showing the
C major scale we see that G has position number five. In the table above we see
that position five and a major chord identifies the mixolydian scale pattern.
Finally, we apply this pattern to the root of the chord and obtain the chord
scale as G(0), A(2), B(4), C(5), D(7), E(9), F(10). The numbers in parentheses
here are the scale pattern applied. </p>

<p>The chords in the chord progression, and their associated scales, provide the necessary
information for accompanying the melody. A rudimental accompaniment can be created with
two parts: a bass line and a chord voicing. A bass line is basically a melody giving a
fundamental rhythm and tone quality to the song. The bass line is typically played in the
lower register, say, C,3-G,4 in Haskore notation. The chord voicing enhances the tonal
quality of the song, thus creating a richer and fatter sound and is typically played in
the mid register, say, E,4-G,5. </p>

<br>

<h2>Generating bass lines</h2>

<p>Bass lines in&nbsp; popular music of today are often based on various stereotypes used
in different musical genres. As a rough example of stereotypes, three different bass
styles are shown below: Basic, Calypso, and Boogie. The notes indicate the rhythmic
pattern of the bass lines. The number below each note shows what note in the chord scale
to be used, starting with 1 as the root. The rhythmic pattern should be interpreted as <em>sound</em>
or <em>silence</em>. Each bar is virtually divided into a number of beats, all having
equal duration. The basic style consists of two beats (half notes), all beats sounding.
The calypso style has a feeling of eight beats; the first two are silent (a quarter note
rest), the following two are sounding (eighth notes), then another two beats of silence
followed by two sounding beats. The boogie style, finally, consists of eight sounding
beats (eighth notes).</p>

<p align="center"><img src="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/basic.gif" width="405" height="80"><br>
<img src="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/calypso.gif" width="400" height="77"><br>
<img src="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/boogie.gif" width="407" height="79"><br>
</p>

<p>As an example, suppose we want to create boogie bass to a bar of Twinkle,
twinkle. There is no bar with a G major chord class only, but to be able to
build on our functional analysis of G major above, let us assume there was one.
Keeping the notes in the interval C,3-G,4 ,the bass of this bar would then consist
of a sequence of eight eighth-notes with the pitches {G,3 - D,4 - E,4 - D,4 - G,3
- D,4 - E,4 - D,4}.

</p>

<p>Now we may turn to slightly more complex situation, which is very common in 
Twinkle, twinkle, namely that there is more than one chord symbol per bar. For
example the third bar has first a G major chord class and then a C major. In the case
of such split bars the bass is constructed by taking only the first half of the bass
pattern and concatenating the notes generated by each of the chords.. A boogie
bass for the third bar would thus consist of eighth-notes with pitches {G,3 -
D,4 - E,4 - D,4 - C,3 - G,3 - A,3 - G,3} (The derivation of the C major chord scale is
left as an exercise to the reader.) A basic bass for the same bar would be two
half-notes with pitches {G,3 and C,3}</p>

<br>
<h2>Generating chord voicing</h2>

<p>The fundamental chord voicing is built on triads (a triad is three notes sounding
simultaneously), changing in accordance with the chord symbols and the melody flow. The
chord changes will thus represent three new melodic lines, although these are not really
independent melodies but created for backing up the melody harmonically. The tones in a
 triad do not have to be chosen from a specific octave - from
a harmonic point of view pitches with the same pitch class value but different octaves are
equivalent (in fact, that is why pitches are represented as they are in Haskore). For example,
 a C major chord can consist of the triad {C,4;E,4;G,4} as well as
{C,5;E,5;G,5}. Furthermore, the order of the tones in a triad needs not to be fixed. The
first note is called the <em>root</em> and the others <em>third</em> and <em>fifth</em>,
respectively. When the bottom note is changed to the third or the fifth instead of the
root, different <em>inversions</em> are created (e.g., {E,4;G,4;C,5} and {G,4;C,5;E,5}).
This freedom in terms of octaves and inversions means that there are many
different chords to choose from for a specific chord class. And some choices
will sound better than others. So the question is how to make good choices.
Although this is essentially a part of the artistic skill of good musicians, some
rules of thumb for good chord voicing does exist:</p>

<ul>
  <li>A first rule of thumb is to keep all chord notes within a limited range. 
    In this exercise E,4-G,5 is suitable.</li>
  <li>A second rule of thumb is to make the changes in
the chord &quot;melodies&quot; as small as possible. Using only triads, there
    will be three such melodies: one consists of the sequence of bottom notes in
    all chords, a second of the sequence of middle notes and the third of the
    sequence of all top notes. The change in a melody is measured in semitones.
    For example going from the C major chord {E,4;G,4;C,5}to the G major chord
    {D,4;G,4;B,4} changes the bottom melody 2 semitones, the middle melody 0
    semitones, and the top melody 1 semitone. The total change is the sum of the
    changes in the melodies, in this case 3. Theoretically you can optimize
    these changes over the whole song but in this assignment it will be
    sufficient to do it one chord at a time.</li>
  <li>And as a third rule of thumb&nbsp;you usually get a &quot;tighter&quot;
    sound by keeping the tones
in the triad as close to each other as possible (<em>closed voicing</em>). For example,&nbsp; {E,4;G,4;C,5} is a C major chord that has a
closed voicing while {E,4;C,5;G,5}is a C major chord that has not.&nbsp;&nbsp;</li>
</ul>



<h1>Preparation</h1>

<p> The preparation for the assignment consists of studying at least chapters 1, 3 and 10 of the 
<a href="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/tutorial.pdf">Haskore tutorial</a> 
and trying out the examples. The Haskore2010.zip file available in /usr/local/cs/EDAN40/ (on student 
  machines) or here: 
  <a href="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/Haskore2010.zip">Haskore2010.zip</a>,
  contains a slightly modified and rudimentarily tested variant of Haskore fitting ghc 7.4.1 (i.e. it
  should fit the assignment needs).<br>
  In order to verify it copy it to a directory you own, unzip, invoke ghci and say<br> 
  <code>:l ChildSong6.lhs</code><br>
  and then<br> <code>test childSong6</code><br> This should create a file called <code>test.mid</code>
  that should be playable by your favourite midi player, e.g. timidity.</p>
<p>It has been pointed out to me that Haskore2010 above does not work with ghc 7.6.3. The
  offending module is HaskoreUtils.hs, that uses <code>catch</code> which no longer can 
  be found.
  To remedy this, insert the following line somewhere by the beginning of the module:<br>
  <code>import Control.Exception hiding (assert)</code> (and make sure that your ghc 
  finds the Control.Exception module:-)</p>

<h1>Assignment</h1>

<h2>1. Melodies</h2>

<p>Melodies often consist of repeating parts, sometimes transposed or otherwise modified
each time. Transcribe the melody of&nbsp; Twinkle Twinkle Little Star into Haskore in a
way that such structures are made explicit. You may want to look at Appendix C in the
Haskore tutorial where another song is encoded in this way. Use the utilities in the
module <font face="Courier" size="-2">TestHaskore</font> to output the results as a midi
file which can be played on the computers which have sound cards.</p>

<h2>2. Accompaniments</h2>

<p>The result of the main part of the assignment is Haskell module for automatic
generation of accompaniment to a given melody. The module should be written as a <b>literate
  Haskell program</b> (.lhs-file) which, at the same time as it is an executable and correct
program, is an essay which explains the types, data structures and functions you have chosen to create the 
  musical accompaniment described above. This explanation must be self-contained in the sense that it is
understandable without access to the Haskore tutorial (so please think about how you present
  your solution). An example of a literate
program is the <a href="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/tutorial.pdf">Haskore 
  tutorial</a> itself.</p>


<p>a) Write a function, <font face="Courier">autoBass</font> which automatically generates
a bass line. Given a bass pattern, a chord progression, and the key of the song, <font
face="Courier">autoBass</font> returns the bass line as a Haskore music object.</p>

<blockquote>
  <p><font face="Courier" size="-2">autoBass :: BassStyle -&gt; Key -&gt; ChordProgression
  -&gt; Music </font></p>
</blockquote>

<p>Test the function with basic, calypso, and boogie styles on the chord progression for
Twinkle Twinkle Little Star. </p>

<p>b) Write a function, <font face="Courier" size="-2">autoChord</font>, which
automatically generates a chord voicing including the guidelines for good
voicing described above. Given a key and a chord progression, <font
face="Courier" size="-2">autoChord</font> returns the chord voicing as a Haskore music
object. </p>

<blockquote>
  <p><font face="Courier" size="-2">autoChord :: Key -&gt; ChordProgression -&gt; Music</font></p>
</blockquote>

<p>Again, test the function on Twinkle, twinkle.</p>

<p>c) Write a function, <font face="Courier" size="-2">autoComp</font> which combines <font
face="Courier" size="-2">autoBass </font>and <font face="Courier" size="-2">autoChord</font>.
Given suitable definitions of twinkleMelody and twinkleChords different
variations of&nbsp; Twinkle Twinkle Little Star could then be generated by
definitions like these: </p>

<p><font face="Courier" size="-2">
&nbsp;&nbsp;&nbsp; twinkleBasic &nbsp; = twinkleMelody :=: autoComp basic (C, Major)
twinkleChords<br>
&nbsp;&nbsp;&nbsp; twinkleCalypso            = twinkleMelody :=: autoComp calypso (C, Major)
twinkleChords<br>
&nbsp;&nbsp;&nbsp; twinkleBoogie&nbsp;      = twinkleMelody :=: autoComp boogie (C, Major)
twinkleChords<br>
</font> </p>

<p>And the calypso version for example might sound something
like <a href="http://fileadmin.cs.lth.se/cs/Education/EDAN40/assignment2/twinkleCalypso.mid">this</a>. </p>

<p>d) Find the score of at least one other song of your own choice and use as a second test case.
 Since the assignment only gives tables for major keys you should of course choose a song in a major key.
 If you have problems finding a score, we have a small collection of songs you may use.</p>

<p><br>
<b>Note: </b>You should be aware that different bass styles require different tempo to
give a good sound and that the relative volume of the different voices (melody, chords,
bass) can be rather important. You may have to do some experiments. While developing the
functions you are recommended to ignore instrumentation (piano is default). But once the
program is working you may want to try different instruments for the different voices, for
example electric or acoustic bass for the bass voice and flute for the chord voicing. 
</p>

<br>

<h1>Submission requirements</h1>

<p>You are to submit three files from this assignment:
<ul>
  <li><font face="Courier">autoComp.lhs</font> which is literate Haskell module with the accompaniment 
    generator. You are reminded that this file will be judged not only as a program but also as a written
    report.</li>
  <li><font face="Courier">twinkle.hs</font> which contains the melody and chord progression of Twinkle 
   Twinkle Little
    Star and the corresponding application of the <font face="Courier" size="-2">autoComp</font>
    function</li>
  <li><font face="Courier">&lt;yourSong&gt;.hs</font> which is the melody and chord progression of the song 
    you have used as your second test case.</li>
</ul></p>
<p>These files together with an estimate of the number of hours spent
on this assignment should no later than November 27th, 2013 be mailed to
<a href="mailto:fp@cs.lth.se">fp@cs.lth.se</a>
with the following subject line</p>
<pre>
Assignment 2 by <em>username1</em> and <em>username2</em>
</pre>
<p>(where <tt><em>username1</em></tt> and <tt><em>username2</em></tt> are your logins).
</p>

			<ul class="linkIconList" style="padding: 10px 0 0 20px; margin: 0"><li id="print">
			<div id="LINK_PRINTABLE"><a href="&#35;" onclick="printWindow(location.href,'2');return false;">Print version</a></div></li></ul>
			<div class="customFoot"><!--###customFoot### begin -->
				<div class="line"><!--###line### begin --><!-- --><!--###line### end --></div>
				<p>
					Page Manager:&nbsp;Jacek Malec<br />Webmaster:&nbsp;<a href="mailto:webmaster@lth.se">webmaster@lth.se</a><br />Last updated:&nbsp;2013-11-14
				</p>
			<!--###customFoot### end --></div>
		<!--###contentMain### end --></div>
	<!--###placeA### end --></div>
</div>


<div style="clear: both;"><!-- --></div>
<!--###columnRight### end --></div>
<!--###rightTd### end --></div>
<div style="clear: both; width: 754px;" class="bottomTd"><!--###bottomTd### begin -->
<div class="mainFootDiv"><!--###mainFootDiv### begin -->
<div class="contentFoot"><!--###contentFoot### begin -->
<a href="typo3/index.php?redirect_url=../index.php?id=44731" >Dept. of Computer Science, LTH, P.O. Box 118, 221 00 Lund, Sweden. Phone: +46 46 2220000</a>
<!--###contentFoot### end --></div>
<div class="clear"><!--###clear### begin --><!-- --><!--###clear### end --></div>
<!--###mainFootDiv### end --></div>
<!--###bottomTd### end --></div>
<div style="clear: both;" class="startBottomShadow"><!--###startBottomShadow### begin --><!-- --><!--###startBottomShadow### end --></div>
<!--###leftColBg### end --></div>
<!--###templateMain### end --></div>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-12582595-1");
pageTracker._trackPageview();
</script>




</body>
</html>